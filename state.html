---
layout: default
---

		<!-- Highcharts library -->
 		<script src="https://cdnjs.cloudflare.com/ajax/libs/highcharts/4.2.1/highcharts.js"></script>


		<!-- Main -->


		<article id="main">

				<header class="special container">
					<span class="icon fa-calendar"></span>
					<h2><strong>TIMELINE</strong> del proyecto</h2>
					<p>Estado</p>
				</header>

				<div id="container" style="width:100%; height:350px;"></div>
				    <script>

						 function readTextFile(file)
							{

								  //Definimos el objeto que vamos a devoler.
									var datos = new Object();
									datos.numCommit = [];
                  datos.lines_UI = [];
									datos.lines_APIG = [];
                  datos.lines_mSBD = [];
									datos.lines_mSCE = [];


							    var rawFile = new XMLHttpRequest();
							    rawFile.open("GET", file, false);
							    rawFile.onreadystatechange = function ()
							    {
							        if(rawFile.readyState === 4)
							        {
							            if(rawFile.status === 200 || rawFile.status == 0)
							            {
							                var allText = rawFile.responseText;
							                alert(allText);

							            }
							        }
							    }
							    rawFile.send(null);

									/*
									Una vez que tengo el texto tendŕia que procesarlo para poder devolver en un formato estructurado
									y con sentido para el gráfico de JS pueda leer los datos bien y de forma simple.
									*/

									var lines = rawFile.responseText.split('\n');
                  //Saltamos la primera que lleva la descripción del formato y la última que lleva el descriptor de cierre.
									for(var line = 1; line < lines.length-1; line++){
										console.log(line);
      							console.log(lines[line]);

										var fields = lines[line].split(';');


									  datos.numCommit.push(parseInt(fields[0]));
                    datos.lines_UI.push(parseInt(fields[2]))
                    datos.lines_APIG.push(parseInt(fields[3]));
                    datos.lines_mSBD.push(parseInt(fields[4]));
                    datos.lines_mSCE.push(parseInt(fields[5]));

										for (var field =0; field<fields.length; field++){
											console.log(field);
											console.log(fields[field]);
										}


    							}

                  console.log("Datos!");
									console.log(datos);
                  return datos
									//return rawFile.responseText;
							}

				      $(function () {

										  //Antes de que se pinte se tiene que acceder al fichero lines.txt y extraer los datos.
											var datos = readTextFile("lines.txt");
                      console.log('Datos procesados');
											console.log(datos);

									    $('#container').highcharts({
									        title: {
									            text: 'Evolución del tamaño del proyecto',
									            x: -20 //center
									        },
                          /*
									        subtitle: {
									            text: 'Source: WorldClimate.com',
									            x: -20
									        },
                          */
									        xAxis: {
                              title: {
                                  text: 'Nº de commits'
                              },
															//El eje x iría el número del commit
									            //categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
                              categories: datos.numCommit
									        },
									        yAxis: {
									            title: {
									                text: 'Nº lineas'
									            },
									            plotLines: [{
									                value: 0,
									                width: 1,
									                color: '#808080'
									            }]
									        },
									        tooltip: {
                              useHTML: true,
                              headerFormat: '<small>commit {point.key}</small></br>',        	  
									            valueSuffix: 'lineas'
									        },
									        legend: {
									            layout: 'vertical',
									            align: 'right',
									            verticalAlign: 'middle',
									            borderWidth: 0
									        },
													//Y en las series el número de lineas que tiene cada submodulo para ese commit
									        series: [
                          {
									            name: 'UI',
                              data: datos.lines_UI
  									      }, {
									            name: 'APIG',
                              data: datos.lines_APIG
									        }, {
									            name: 'mSBD',
                              data: datos.lines_mSBD
									        }, {
									            name: 'mSCE',
                              data: datos.lines_mSCE
									        }]
									    });





				          });
				    </script>

				</article>
